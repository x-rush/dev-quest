# 任务定义和执行规则

> **使用说明**: 定义具体任务的模板，每个任务都包含详细的执行和验证规则。

## 📋 任务定义模板

### 基础任务模板

```markdown
## 任务ID: [模块代码]-[序号]
**任务名称**: [简洁明确的任务名称]
**任务类型**: [文档生成/代码编写/目录创建/文件操作等]
**优先级**: [高/中/低]
**预估时间**: [数字分钟]
**阶段**: [所属的执行阶段]

### 任务描述
[详细描述这个任务要完成什么，为什么要做这个任务]

### 前置条件
- [ ] [条件1]: [具体要求]
- [ ] [条件2]: [具体要求]
- [ ] [条件3]: [具体要求]

### 执行步骤
1. **步骤1**: [具体操作描述]
   - 输入: [需要什么输入]
   - 输出: [期望的输出]
   - 验证: [如何验证这步成功]

2. **步骤2**: [具体操作描述]
   - 输入: [需要什么输入]
   - 输出: [期望的输出]
   - 验证: [如何验证这步成功]

3. **步骤3**: [具体操作描述]
   - 输入: [需要什么输入]
   - 输出: [期望的输出]
   - 验证: [如何验证这步成功]

### 输出标准
**必须满足的条件**:
- [ ] [标准1]: [具体描述]
- [ ] [标准2]: [具体描述]
- [ ] [标准3]: [具体描述]

**质量要求**:
- [ ] 内容准确性: [具体要求]
- [ ] 格式规范性: [具体要求]
- [ ] 技术标准: [具体要求]

### 验证方法
**自动验证**:
- [ ] 文件存在性检查
- [ ] 内容格式验证
- [ ] 语法正确性检查
- [ ] 链接完整性检查

**人工验证**:
- [ ] 内容质量评估
- [ ] 技术准确性检查
- [ ] 用户体验评估

### 异常处理
**可能异常1**: [异常描述]
- **检测方法**: [如何发现这个异常]
- **处理策略**: [自动修复/人工干预/跳过/重试]
- **重试次数**: [数字]次
- **上报机制**: [是否需要上报人工]

**可能异常2**: [异常描述]
- **检测方法**: [如何发现这个异常]
- **处理策略**: [自动修复/人工干预/跳过/重试]
- **重试次数**: [数字]次
- **上报机制**: [是否需要上报人工]

### 完成标志
**主要标志**: [最关键的完成指标]
**次要标志**: [辅助完成指标]
**质量标志**: [质量达成的指标]

### 依赖关系
**前置任务**: [依赖的任务ID列表]
**后续任务**: [依赖此任务的任务ID列表]
**并行任务**: [可以并行执行的任务ID列表]

### 资源需求
**系统资源**: [CPU/内存/磁盘空间要求]
**外部依赖**: [需要的外部工具或服务]
**网络要求**: [是否需要网络连接]

### 执行日志格式
```
[时间戳] 任务开始: [任务ID] [任务名称]
[时间戳] 步骤1完成: [步骤描述]
[时间戳] 步骤2完成: [步骤描述]
[时间戳] 验证通过: [验证结果]
[时间戳] 任务完成: [完成状态]
```
```

## 🏷️ 任务类型定义

### 1. 目录结构创建 (DIR_CREATE)
**标准模板**:
- 验证目录不存在或已备份
- 创建完整目录结构
- 验证权限和可访问性

**验证规则**:
```bash
# 验证目录存在
test -d [目录路径]

# 验证权限
ls -la [目录路径]

# 验证结构
tree [目录路径]
```

### 2. 文档生成 (DOC_GENERATE)
**标准模板**:
- 分析模板和示例
- 生成符合标准的内容
- 验证格式和结构

**验证规则**:
```markdown
# 文档结构检查
- [ ] 标题层级正确 (H1 → H2 → H3)
- [ ] 代码块语法高亮正确
- [ ] 链接格式正确
- [ ] 列表格式正确

# 内容质量检查
- [ ] 技术内容准确
- [ ] 代码示例可执行
- [ ] 描述清晰易懂
- [ ] 符合项目标准
```

### 3. 代码文件生成 (CODE_GENERATE)
**标准模板**:
- 定义代码结构和功能
- 编写符合规范的代码
- 添加注释和文档

**验证规则**:
```typescript
// 语法检查
// 编译测试
// 功能测试
// 代码风格检查

// 验证清单
- [ ] 语法无错误
- [ ] 符合编码规范
- [ ] 包含必要注释
- [ ] 通过基本测试
```

### 4. 文件复制/移动 (FILE_OPERATION)
**标准模板**:
- 检查源文件存在
- 执行复制/移动操作
- 验证目标文件正确

**验证规则**:
```bash
# 文件存在性
test -f [文件路径]

# 文件大小
ls -lh [文件路径]

# 文件内容
head -10 [文件路径]
```

### 5. 配置更新 (CONFIG_UPDATE)
**标准模板**:
- 备份原配置
- 更新配置内容
- 验证配置正确性

**验证规则**:
```yaml
# 配置语法检查
# 配置逻辑验证
# 功能测试验证
```

## 🔄 任务状态管理

### 状态定义
- **PENDING**: 等待执行
- **IN_PROGRESS**: 正在执行
- **VALIDATING**: 验证中
- **COMPLETED**: 已完成
- **FAILED**: 执行失败
- **BLOCKED**: 被阻塞
- **SKIPPED**: 已跳过
- **NEEDS_REVIEW**: 需要人工检查

### 状态转换规则
```
PENDING → IN_PROGRESS → VALIDATING → COMPLETED
    ↓         ↓           ↓         ↓
  BLOCKED  FAILED     NEEDS_REVIEW  (结束)
    ↓         ↓           ↓
  (等待)    (重试)     (人工检查)
```

## 📊 任务分组和依赖

### 任务组定义
```markdown
## 任务组: [组名称]
**组ID**: [GROUP-XXX]
**并行执行**: [是/否]
**组内任务**:
- [任务ID1]: [任务名称]
- [任务ID2]: [任务名称]
- [任务ID3]: [任务名称]

**组完成条件**:
- [ ] 所有任务都完成
- [ ] 至少 [数量] 个任务完成
- [ ] 关键任务 [任务ID] 完成
```

### 依赖关系图
```
任务A → 任务B → 任务C
   ↓       ↓
任务D → 任务E
```

## ⚡ 执行优化策略

### 并行执行
- **独立任务**: 无依赖关系的任务可以并行执行
- **资源竞争**: 避免同时修改相同文件的任务
- **负载均衡**: 合理分配系统资源

### 批处理
- **相似任务**: 同类型任务可以批量处理
- **模板化**: 使用模板提高生成效率
- **缓存机制**: 缓存常用结果和中间数据

### 错误恢复
- **断点续传**: 记录执行位置，支持中断恢复
- **增量更新**: 只处理变化的部分
- **回滚机制**: 支持回滚到之前的状态

## 📝 质量检查清单

### 自动检查项目
```markdown
## 每个任务必检项目
- [ ] 文件/目录创建成功
- [ ] 内容格式正确
- [ ] 语法无错误
- [ ] 链接有效
- [ ] 权限设置正确
```

### 人工检查项目
```markdown
## 关键任务检查项目
- [ ] 内容质量符合标准
- [ ] 技术信息准确
- [ ] 用户体验良好
- [ ] 与项目整体一致
```

---

**注意**: 根据具体项目需求调整任务定义模板，确保每个任务都有明确的执行标准和验证方法。